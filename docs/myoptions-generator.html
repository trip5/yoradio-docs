<!DOCTYPE html>
<html>
<head>
  <script>
    var GVERSION="v0.9.0";
    var LASTID="r79";
    var debug = false;
  </script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, minimum-scale=0.25">
  <meta name="mobile-web-app-capable" content="yes"><!-- apple-mobile-web-app-capable is deprecated. -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAgVBMVEUAAADXwlPcyVjYw1PYxFTcyVjYxFTbyFfZxlXax1bcyVjax1bbyFfaxlbaxlbbyFfZxVXZxVXbx1fbyFfcyFjbx1fcyVjYxFTZxVXZxVXbx1fcyFfaxlbcyFjcyVjcyVjax1bcyVjcyVjaxlbaxlbbyFfbyFfcyVjax1bbyFfWwVJAMS6TAAAAKnRSTlMA+wv49AXsas+jFp+Cy71T496PTD+IM/Dn2ZpHxzknHbEtDsK5dVwjrF8iY+RUAAAB/UlEQVRYw+2W2ZabMBBE1QgkxA4GjPHu8TLp///ATBxsKcRIzeQhOSdz30qm6ohuqTH7R4kSpeIr0+S9UsmN7JclR0T/bT9o77wERCgSqt/Hn5Snuw7CQfOG5A8EPlD3heSp/R0l4IJPePChvUIvxJSADDX3ANSElIDQErCiBBzGAaD1hhKwwCci0E24Q2vkCh/IUWIXkAJ25aPmw/PNoEXNaBx7AcBX0ht0cA05gFAto+K168XaPDS3D709sf+Qm4yVUnG1/pS7Pi8B8A5A0Xsz7XkB+AuQzYpIAX+DJ2T7domvgIzo/8ZxgpDkX3Cc5EAZ6T5OA5JymW0Ipz+BUe1HW+hdAQIN3mrP8/YxzNhCYzzM62Gg7Dt6FTrUtLqwS2NX5BbGgXGyqe/wjppIL5tb4EdbQKn9pTnBThtiEYx3VZGniSodUNluETd64JsYP7xbAtYc3Wzsx9BNagmo/npAA39YgwslILONcqMLMIGf2D7s3Plfgj4NSu8zASFqaorB1sdix+Zz5GbDt2zMft5M7mQbGDOhzauzM0ACmhS9zBd1vchz2WQdIETOhBJHABfCBxjE1f1d52ijZ06U4xy72aCFkhAQpDiNzygcpuvA96SES4ETQM5IRHEBr+wi2zIiUZN2vun1xSpr2nkXQ8aHNPxBmsWVbNkXr/kONfy904/qMY8AAAAASUVORK5CYII=">
  <title>ёRadio - simple myoptions.h generator</title>
  <link href="stylesheet.css" rel="stylesheet">
  <link id="board-css" rel="stylesheet" href="ESP32-DevKit-V1_38Pin/ESP32-DevKit-V1_38Pin-Preview.css">
</head>
<body>
  <div id="board-area"><!-- preview: dynamic board .css and .html and .jpg inserted here--></div>
  <div id="content">
    <div id="alert" class="hidden" onclick="dontAlert();"></div>
    <h1 id="pagetitle">ёRadio - myoptions generator</h1>
    <h2 id="slogan">feel difference</h2>
    <!-- BOARD SELECT  -->
    <div class="board-select">
	    <label for="board-select">Select Board:</label>
	    <select id="board-select">
	      <option value="ESP32-DevKit-V1_38Pin">ESP32-DevKit-V1 (38 Pin)</option>
	      <option value="ESP32-S3-DevKitC-1_44Pin">ESP32-S3-DevKitC-1 (44 Pin)</option>
	      <option value="ESP32-S3-DevKitC-1_42Pin">ESP32-S3-DevKitC-1 (42 Pin)</option>
        <option value="ESP32-S3-Adafruit_Feather">ESP32-S3 Adafruit Feather</option>
	    </select>
    </div><!-- BOARD SELECT -->
    <!-- INFO -->
    <section id="info">
      <div id="esp-board-area"><!-- dynamic ESP board .html inserted here --></div>
    </section><!-- INFO -->
    <!-- BOARD PINOUT (HIDDEN)-->
    <div class="evenly">
      <div class="button apply" title="Show or hide board pinout" id="board-pinout-button" onclick="boardViewClick();">show board pinout</div>
    </div>
    <section id="board-pinout-area" class="board-pinout-area hidden">
      <img id="board-pinout-img" src="ESP32-DevKit-V1_38Pin/ESP32-DevKit-V1_38Pin-Board.jpg" />
    </section><!-- BOARD PINOUT (HIDDEN)-->
    <!-- MODULE -->
    <hr class="double" />
    <section id="module">
      <div class="title"><span>module type</span></div><div class="help" data-targetid="help-ban-pins" data-title="module type">?</div>
      <div class="evenly">
        <label class="dsplabel"><input type="radio" class="radio espmodule rbox" name="espmodule" id="r71" data-target="option-no-ban-pins" checked /><span class="checkmark"></span><div id="no-ban-pins-label">PSRAM is less than 8MB xxx</div></label> 
        <label class="dsplabel"><input type="radio" class="radio espmodule rbox" name="espmodule" id="r72" data-target="option-ban-pins" /><span class="checkmark"></span><div id="ban-pins-label">PSRAM is 8MB or more xxx</div></label>
      </div>
    </section><!-- MODULE -->
    <!-- SETUP -->
    <hr class="double" />
    <section id="setup">
      <div class="title"><span>i need to set up</span></div><div class="help" data-targetid="help-setup" data-title="setup section">?</div>
      <div class="scontent scontent-setup evenly" id="scontent-setup1">
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r1" data-target="setup-language"/><span class="checkmark box"></span>language</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r2" data-target="setup-display"/><span class="checkmark box"></span>DISPLAY</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r3" data-target="setup-buttons"/><span class="checkmark box"></span>BUTTONS</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r4" data-target="setup-encoders"/><span class="checkmark box"></span>ENCODERS</label>
      </div>
      <hr />
      <div class="scontent scontent-setup evenly" id="scontent-setup2">
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r5" data-target="setup-touchscreen"/><span class="checkmark box"></span>TOUCHSCREEN</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r6" data-target="setup-sdcard"/><span class="checkmark box"></span>SD CARD</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r76" data-target="setup-rtc"/><span class="checkmark box"></span>RTC</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox" id="r7" data-target="setup-etc"/><span class="checkmark box"></span>IR, LED, ETC.</label>
      </div>
    </section><!-- SETUP -->
    <!-- LANGUAGE -->
    <div id="setup-language" class="hidden">
      <hr class="double" />
      <section id="language">
        <div class="title"><span>language</span></div><div class="help" data-targetid="help-language" data-title="language">?</div>
        <div class="scontent scontent-language evenly forexport" id="scontent-language" data-define="L10N_LANGUAGE" data-export="RADIO">
          <label class="dsplabel"><input type="radio" class="radio rbox" name="rlanguage" id="r8" data-type="default" checked /><span class="checkmark"></span>EN</label>
          <label class="dsplabel"><input type="radio" class="radio rbox" name="rlanguage" id="r9" data-type="RU" /><span class="checkmark"></span>RU</label>
        </div>
      </section>
    </div><!-- LANGUAGE -->
    <!-- DISPLAY -->
    <div id="setup-display" class="hidden">
      <hr class="double" />
      <section id="display">
        <div class="title"><span>display</span></div><div class="help" data-targetid="help-display" data-title="displays">?</div>
        <div class="scontent scontent-displays forexport" id="scontent-displays" data-define="DSP_MODEL" data-export="RADIO" data-displays="true">
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r10" data-target="dmy" data-type="default" checked /><span class="checkmark"></span>no display</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r11" data-target="spi" data-st="ST7735" data-type="DSP_ST7735" data-libs="Adafruit ST7735 and ST7789 Library" /><span class="checkmark"></span>ST7735</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r12" data-target="i2c" data-type="DSP_SSD1306" data-libs="Adafruit SSD1306" data-invert="true"/><span class="checkmark"></span>SSD1306</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r13" data-target="spi" data-type="DSP_NOKIA5110" data-libs="Adafruit PCD8544 Nokia 5110 LCD library" /><span class="checkmark"></span>NOKIA 5110</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r14" data-target="spi" data-type="DSP_ST7789" data-libs="Adafruit ST7735 and ST7789 Library" /><span class="checkmark"></span>ST7789</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r15" data-target="i2c" data-type="DSP_SH1106" data-libs="Adafruit SH110X" data-invert="true" /><span class="checkmark"></span>SH1106</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r16" data-target="i2c" data-type="DSP_1602I2C" /><span class="checkmark"></span>1602 I2C</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r17" data-target="i2c" data-type="DSP_SSD1306x32" data-libs="Adafruit SSD1306" /><span class="checkmark"></span>SSD1306x32</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r18" data-target="i2c" data-type="DSP_SSD1327" data-libs="Adafruit SSD1327" data-rotate="true" /><span class="checkmark"></span>SSD1327</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r19" data-target="spi" data-type="DSP_ILI9341" data-libs="Adafruit ILI9341" /><span class="checkmark"></span>ILI9341</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r20" data-target="spi" data-type="DSP_SSD1305" data-libs="Adafruit SSD1305" data-invert="true" /><span class="checkmark"></span>SSD1305</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r21" data-target="i2c" data-type="DSP_SH1107" data-libs="Adafruit SH110X" /><span class="checkmark"></span>SH1107</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r22" data-target="lcd" data-type="DSP_1602" /><span class="checkmark"></span>LCD 1602</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r23" data-target="spi" data-type="DSP_GC9106" /><span class="checkmark"></span>GC9106</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r24" data-target="i2c" data-type="DSP_2004I2C" /><span class="checkmark"></span>2004 I2C</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox" name="dspradio" id="r25" data-target="lcd" data-type="DSP_2004" /><span class="checkmark"></span>LCD 2004</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r26" data-target="i2c" data-type="DSP_SSD1305I2C" data-invert="true" /><span class="checkmark"></span>SSD1305 I2C</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r27" data-target="spi" data-type="DSP_ILI9225" /><span class="checkmark"></span>ILI9225</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r28" data-target="spi" data-type="DSP_ST7789_240" data-libs="Adafruit ST7735 and ST7789 Library" data-rotate="true" /><span class="checkmark"></span>ST7789x240</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r29" data-target="spi" data-type="DSP_ST7796" /><span class="checkmark"></span>ST7796</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r30" data-target="spi" data-type="DSP_GC9A01A" /><span class="checkmark"></span>GC9A01A</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r31" data-target="spi" data-type="DSP_ILI9488" /><span class="checkmark"></span>ILI9488</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r32" data-target="spi" data-type="DSP_ILI9486" /><span class="checkmark"></span>ILI9486</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r73" data-target="spi" data-type="DSP_SSD1322" /><span class="checkmark"></span>SSD1322</label>
          <label class="dsplabel"><input type="radio" class="radio dspradio rbox libs-required adafruit" name="dspradio" id="r74" data-target="spi" data-type="DSP_ST7920" /><span class="checkmark"></span>ST7920</label>
        </div>
        <hr style="margin: 10px 40px 20px 40px;" />
        <div class="evenly">
          <label class="dsplabel"><input type="checkbox" class="checkbox rbox plus-nextion" name="dspbox" id="r33" /><span class="checkmark box"></span>+ NEXTION</label>
          <label class="dsplabel hidden" id="dsp-rotate" title="Optional 90 degree rotation for square displays"><input type="checkbox" class="checkbox rbox rotate90" id="r34" name="dspbox" /><span class="checkmark box"></span>ROTATE 90&#176;</label>
          <label class="dsplabel hidden" id="dsp-invert" title="Invert title colors for OLED displays"><input type="checkbox" class="checkbox rbox invert-title" id="r35" name="dspbox" /><span class="checkmark box"></span>INVERT TITLE</label>
        </div>
        <div class="description"><a href="https://github.com/e2002/yoradio/wiki/Available-display-models" target="_blank">Available display models</a></div>
      </section>
      <section id="display-pins" class="hidden">
        <div class="title"><span>display pins</span></div><div class="help" data-targetid="help-display-pins" data-title="display pins">?</div>
        <div class="scontent scontent-displays-pins">
          <div id="pins-7735" class="hidden">
            <h3 class="subtitle">ST7735 display type</h3>
            <div class="evenly forexport" data-define="DTYPE" data-export="RADIO">
              <label class="dsplabel" title="1.8' display. If the display is cut off or has extra 'random' pixels on the top & left, try the other option!"><input type="radio" id="r36" class="radio dspradio rbox initr-blacktab" name="initrradio" data-type="default" checked /><span class="checkmark"></span>BLACKTAB</label>
              <label class="dsplabel" title="1.8' display. If the display is cut off or has extra 'random' pixels on the top & left, try the other option!"><input type="radio" class="radio dspradio rbox" id="r37" name="initrradio" data-type="INITR_GREENTAB" /><span class="checkmark"></span>GREENTAB</label>
              <label class="dsplabel" title="1.8' display. If the display is cut off or has extra 'random' pixels on the top & left, try the other option!"><input type="radio" class="radio dspradio rbox" id="r38" name="initrradio" data-type="INITR_REDTAB" /><span class="checkmark"></span>REDTAB</label>
              <label class="dsplabel" title="1.44' display."><input type="radio" class="radio dspradio rbox" id="r39" name="initrradio" data-rotate="true" data-type="INITR_144GREENTAB" /><span class="checkmark"></span>144GREENTAB</label>
              <label class="dsplabel" title="0.96' display."><input type="radio" class="radio dspradio rbox" id="r40" name="initrradio" data-type="INITR_MINI160x80" /><span class="checkmark"></span>MINI160x80</label>
            </div>
            <hr /> 
          </div>
          <div id="pins-spi" class="hidden displays-spi">
            <div id="display-spi-mode-wrap">
              <h3 class="subtitle">DISPLAY SPI BUS</h3>
              <div id="display-spi-mode" class="forexport" data-define="DSP_HSPI" data-export="RADIO">
                <label class="dsplabel"><input type="radio" class="radio rbox spitype vspi" id="r41" name="dspspitype" data-type="default" data-define="TFT_" data-color="blue" checked /><span class="checkmark"></span><span id="vspi-text1">VSPI (mosi-23, miso-19, sck-18)</span></label>
                <label class="dsplabel"><input type="radio" class="radio rbox spitype hspi" id="r42" name="dspspitype" data-type="true" data-define="TFT_" data-color="blue" /><span class="checkmark"></span><span id="hspi-text1">HSPI (mosi-13, miso-12, sck-14)</span></label>
              </div>
              <hr />
            </div>
            <div id="display-pins-spi" class="forexport" data-export="PINS">
              <div class="inputwrap"><span class="inputtitle">DC</span><input type="text" class="textinput" id="i1" data-define="TFT_DC" data-color="blue" value="4" maxlength="3"></div>
              <div class="inputwrap"><span class="inputtitle">CS</span><input type="text" class="textinput" id="i2" data-define="TFT_CS" data-color="blue" value="5" maxlength="3"></div>
              <div class="inputwrap"><span class="inputtitle">RST</span><input type="text" class="textinput" id="i3" data-define="TFT_RST" data-color="blue" value="-1" maxlength="3"></div>
              <div class="inputwrap"><span class="inputtitle">BACKLIGHT</span><input type="text" class="textinput" id="i4" data-define="BRIGHTNESS_PIN" data-color="blue" value="255" maxlength="3"></div>
            </div>
          </div>
          <div id="pins-i2c" class="hidden displays-pins forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">SDA</span><input type="text" class="textinput" id="i5" data-define="I2C_SDA" data-color="blue" value="21" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">SCL</span><input type="text" class="textinput" id="i6" data-define="I2C_SCL" data-color="blue" value="22" maxlength="3"></div>
          </div>
          <div id="pins-lcd" class="hidden displays-pins forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">RS</span><input type="text" class="textinput" id="i7" data-define="LCD_RS" data-color="blue" value="" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">E</span><input type="text" class="textinput" id="i8" data-define="LCD_E" data-color="blue" value="" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">D4</span><input type="text" class="textinput" id="i9" data-define="LCD_D4" data-color="blue" value="" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">D5</span><input type="text" class="textinput" id="i10" data-define="LCD_D5" data-color="blue" value="" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">D6</span><input type="text" class="textinput" id="i11" data-define="LCD_D6" data-color="blue" value="" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">D7</span><input type="text" class="textinput" id="i12" data-define="LCD_D7" data-color="blue" value="" maxlength="3"></div>
          </div>
        </div>
      </section>
      <section id="nextion" class="hidden"><div class="help" data-targetid="help-nextion" data-title="nextion pins">?</div>
        <div class="title"><span>nextion pins</span></div>
        <div id="pins-nextion" class="displays-pins forexport" data-export="PINS">
          <div class="inputwrap"><span class="inputtitle">RX</span><input type="text" class="textinput" id="i13" data-define="NEXTION_RX" data-color="white" value="" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">TX</span><input type="text" class="textinput" id="i14" data-define="NEXTION_TX" data-color="white" value="" maxlength="3"></div>
        </div>
      </section>
    </div><!-- DISPLAY -->
    <!-- AUDIO -->
    <hr class="double" />
    <section id="audio">
      <div class="title"><span>audio</span></div><div class="help" data-targetid="help-audio" data-title="audio module">?</div>
      <div class="scontent scontent-audio forexport" id="scontent-audio" data-export="AUDIO">
        <label class="dsplabel"><input type="radio" class="radio rbox" id="r43" name="audioradio" data-target="i2s" checked /><span class="checkmark"></span>I2S EXTERNAL</label>
        <label class="dsplabel"><input type="radio" class="radio rbox vs1053" id="r44" name="audioradio" data-target="vs"  /><span class="checkmark"></span>VS1053</label>
        <label class="dsplabel"><input type="radio" class="radio rbox i2s-internal" id="r45" name="audioradio" data-target="int"  /><span class="checkmark"></span>INTERNAL</label>
        <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-setup rbox force-mono" id="r46" data-target="PLAYER_FORCE_MONO"/><span class="checkmark box"></span>MONO</label>
      </div>
    </section>
    <section id="audio-pins">
      <div class="title"><span>audio pins</span></div><div class="help" data-targetid="help-audio-pins" data-title="audio module pins">?</div>
      <div class="scontent scontent-audio-pins">
        <div id="audio-pins-i2s" class="audio-pins forexport" data-export="PINS">
          <div class="inputwrap"><span class="inputtitle">DIN | DOUT</span><input type="text" class="textinput" id="i15" data-define="I2S_DOUT" data-color="orange" value="27" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">BCLK</span><input type="text" class="textinput" id="i16" data-define="I2S_BCLK" data-color="orange" value="26" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">LRC | WSEL</span><input type="text" class="textinput" id="i17" data-define="I2S_LRC" data-color="orange" value="25" maxlength="3"></div>
        </div>
        <div id="audio-pins-spi-wrap" class="hidden audio-pins">
          <div id="audio-spi-mode-wrap">
            <h3 class="subtitle">AUDIO SPI BUS</h3>
            <div id="audio-spi-mode" class="forexport" data-define="VS_HSPI" data-export="RADIO">
              <label class="dsplabel"><input type="radio" class="radio rbox spitype vspi" id="r47" name="audiospitype" data-type="default" data-define="VS_" data-color="orange" checked /><span class="checkmark"></span><span id="vspi-text2">VSPI (mosi-23, miso-19, sck-18)</span></label>
              <label class="dsplabel"><input type="radio" class="radio rbox spitype hspi" id="r48" name="audiospitype" data-type="true" data-define="VS_" data-color="orange" /><span class="checkmark"></span><span id="hspi-text2">HSPI (mosi-13, miso-12, sck-14)</span></label>
            </div>
            <hr />
          </div>
          <div id="audio-pins-spi" class="forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">CS</span><input type="text" class="textinput" id="i18" data-define="VS1053_CS" data-color="orange" value="27" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">DCS</span><input type="text" class="textinput" id="i19" data-define="VS1053_DCS" data-color="orange" value="25" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">DREQ</span><input type="text" class="textinput" id="i20" data-define="VS1053_DREQ" data-color="orange" value="26" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">RST</span><input type="text" class="textinput" id="i21" data-define="VS1053_RST" data-color="orange" value="-1" maxlength="3"></div>
          </div>
        </div>
      </div>
    </section><!-- AUDIO -->
    <!-- BUTTONS -->
    <div id="setup-buttons" class="hidden">
      <hr class="double" />
      <section id="buttons">
        <div class="title"><span>buttons</span></div><div class="help" data-targetid="help-buttons" data-title="buttons">?</div>
        <div class="scontent scontent-buttons evenly" id="scontent-buttons">
          <label class="dsplabel"><input type="checkbox" class="checkbox rbox control-buttons libs-required" name="buttonsuse" id="r49" data-libs="OneButton" /><span class="checkmark box"></span>control buttons</label>
          <label class="dsplabel hiddenradio hidden"><input type="radio" class="radio rbox" id="r50" name="buttonsnum" data-target="treebuttons" checked /><span class="checkmark"></span>THREE BUTTONS</label>
          <label class="dsplabel hiddenradio hidden"><input type="radio" class="radio rbox five-buttons" id="r51" name="buttonsnum" data-target="fivebuttons"  /><span class="checkmark"></span>FIVE BUTTONS</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox rbox mode-button libs-required" name="buttonmode" id="r52" data-libs="OneButton" /><span class="checkmark box"></span>MODE BUTTON</label>
        </div>
      </section>
      <section id="buttons-pins" class="hidden">
        <div class="title"><span>buttons pins</span></div><div class="help" data-targetid="help-buttons-pins" data-title="buttons pins">?</div>
        <div id="pins-buttons" class="buttons-pins evenly forexport" data-export="PINS">
          <div class="inputwrap threebuttons pinbuttons hidden"><span class="inputtitle">PREV</span><input type="text" class="textinput" id="i22" data-define="BTN_LEFT" data-color="purple" value="" maxlength="3"></div>
          <div class="inputwrap threebuttons pinbuttons hidden"><span class="inputtitle">PLAY</span><input type="text" class="textinput" id="i23" data-define="BTN_CENTER" data-color="purple" value="" maxlength="3"></div>
          <div class="inputwrap threebuttons pinbuttons hidden"><span class="inputtitle">NEXT</span><input type="text" class="textinput" id="i24" data-define="BTN_RIGHT" data-color="purple" value="" maxlength="3"></div>
          <div class="inputwrap fivebuttons pinbuttons hidden"><span class="inputtitle">UP</span><input type="text" class="textinput" id="i25" data-define="BTN_UP" data-color="purple" value="" maxlength="3"></div>
          <div class="inputwrap fivebuttons pinbuttons hidden"><span class="inputtitle">DOWN</span><input type="text" class="textinput" id="i26" data-define="BTN_DOWN" data-color="purple" value="" maxlength="3"></div>
          <div class="inputwrap hidden" id="modebutton"><span class="inputtitle">MODE</span><input type="text" class="textinput" id="i27" data-define="BTN_MODE" data-color="purple" value="" maxlength="3"></div>
        </div>
        <hr />
        <div class="evenly"><label class="dsplabel"><input type="checkbox" class="checkbox rbox buttonspullup" name="buttonpullup" id="r53" checked /><span class="checkmark box"></span>INTERNAL PULLUP</label></div>
      </section>
    </div><!-- BUTTONS -->
    <!-- ENCODERS -->
    <div id="setup-encoders" class="hidden">
      <hr class="double" />
      <section id="encoders">
        <div class="title"><span>encoders</span></div><div class="help" data-targetid="help-encoders" data-title="encoders">?</div>
        <div class="scontent scontent-encoders evenly" id="scontent-encoders">
          <label class="dsplabel"><input type="checkbox" class="checkbox encodercheckbox rbox encoder-box1 libs-required" name="encoder1" id="r54" data-libs="OneButton" /><span class="checkmark box"></span>ENCODER #1</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox encodercheckbox rbox encoder-box2 libs-required" name="encoder2" id="r55" data-libs="OneButton" /><span class="checkmark box"></span>ENCODER #2</label>
        </div>
      </section>
      <section id="encoders-pins" class="hidden">
        <div class="title"><span>encoders pins</span></div><div class="help" data-targetid="help-encoders-pins" data-title="encoders pins">?</div>
        <div id="epins1" class="hidden">
          <h3 class="subtitle">Encoder #1</h3>
          <div class="evenly forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">S1</span><input type="text" class="textinput" id="i28" data-define="ENC_BTNR" data-color="green" value="36" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">S2</span><input type="text" class="textinput" id="i29" data-define="ENC_BTNL" data-color="green" value="34" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">Key</span><input type="text" class="textinput" id="i30" data-define="ENC_BTNB" data-color="green" value="39" maxlength="3"></div>
          </div>
          <div class="encoder-set evenly forexport" data-export="SET">
            <label class="dsplabel"><input type="checkbox" class="checkbox setitem rbox" name="enc1pullup" id="r56" data-default="true" data-define="ENC_INTERNALPULLUP" /><span class="checkmark box"></span>INTERNAL PULLUP</label>
            <label class="dsplabel"><input type="checkbox" class="checkbox setitem rbox" name="enc1half" id="r57" data-default="false" data-define="ENC_HALFQUARD" /><span class="checkmark box"></span>HALFQUARD</label>
          </div>
        </div>
        <hr id="ehr" class="hidden" />
        <div id="epins2" class="hidden">
          <h3 class="subtitle">Encoder #2</h3>
          <div class="evenly forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">S1</span><input type="text" class="textinput" id="i31" data-define="ENC2_BTNR" data-color="lblue" value="35" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">S2</span><input type="text" class="textinput" id="i32" data-define="ENC2_BTNL" data-color="lblue" value="33" maxlength="3"></div>
            <div class="inputwrap"><span class="inputtitle">Key</span><input type="text" class="textinput" id="i33" data-define="ENC2_BTNB" data-color="lblue" value="32" maxlength="3"></div>
          </div>
          <div class="encoder-set evenly forexport" data-export="SET">
            <label class="dsplabel"><input type="checkbox" class="checkbox setitem rbox" name="enc2pullup" id="r58" data-default="true" data-define="ENC2_INTERNALPULLUP" /><span class="checkmark box"></span>INTERNAL PULLUP</label>
            <label class="dsplabel"><input type="checkbox" class="checkbox setitem rbox" name="enc2half" id="r59" data-default="false" data-define="ENC2_HALFQUARD" /><span class="checkmark box"></span>HALFQUARD</label>
          </div>
        </div>
      </section>
    </div><!-- ENCODERS -->
    <!-- TOUCHSCREEN -->
    <div id="setup-touchscreen" class="hidden">
      <hr class="double" />
      <section id="touchscreen">
        <div class="title"><span>touch screen</span></div><div class="help" data-targetid="help-touchscreen" data-title="touchscreen">?</div>
        <div class="evenly forexport" data-define="TS_MODEL" data-export="RADIO">
          <label class="dsplabel"><input type="radio" class="radio tsradio rbox touchscreen-xpt libs-required" name="touchscreenmodel" id="r60" data-target="ts-res" data-type="TS_MODEL_XPT2046" data-libs="XPT2046_Touchscreen" checked /><span class="checkmark"></span>XPT2046</label>
          <label class="dsplabel"><input type="radio" class="radio tsradio rbox" name="touchscreenmodel" id="r61" data-target="ts-cap" data-type="TS_MODEL_GT911"  /><span class="checkmark"></span>GT911</label>
        </div>
        <hr />
        <div class="ts-pins" id="ts-res">
          <h3 class="subtitle" style="margin-top: -30px;">TS SPI BUS</h3>
          <div class="evenly forexport" data-define="TS_HSPI" data-export="RADIO">
            <label class="dsplabel"><input type="radio" class="radio rbox spitype vspi" id="r62" name="tsspitype" data-type="default" data-define="TS_" data-color="yellow" checked /><span class="checkmark"></span><span id="vspi-text3">VSPI (mosi-23, miso-19, sck-18)</span></label>
            <label class="dsplabel"><input type="radio" class="radio rbox spitype hspi" id="r63" name="tsspitype" data-type="true" data-define="TS_" data-color="yellow" /><span class="checkmark"></span><span id="hspi-text3">HSPI (mosi-13, miso-12, sck-14)</span></label>
          </div>
          <hr class="simple" />
          <div class="evenly forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">CS</span><input type="text" class="textinput" id="i34" data-define="TS_CS" data-color="yellow" value="13" maxlength="3"></div>
          </div>
        </div>
        <div class="ts-pins evenly hidden forexport" id="ts-cap" data-export="PINS">
          <div class="inputwrap"><span class="inputtitle">SDA</span><input type="text" class="textinput" id="i35" data-define="TS_SDA" data-color="yellow" value="33" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">SCL</span><input type="text" class="textinput" id="i36" data-define="TS_SCL" data-color="yellow" value="32" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">INT</span><input type="text" class="textinput" id="i37" data-define="TS_INT" data-color="yellow" value="21" maxlength="3"></div>
          <div class="inputwrap"><span class="inputtitle">RST</span><input type="text" class="textinput" id="i38" data-define="TS_RST" data-color="yellow" value="22" maxlength="3"></div>
        </div>
      </section>
    </div><!-- TOUCHSCREEN -->
    <!-- SDCARD -->
    <div id="setup-sdcard" class="hidden">
      <hr class="double" />
      <section id="sdcard">
        <div class="title"><span>sd card</span></div><div class="help" data-targetid="help-sdcard" data-title="sd card">?</div>
        <div class="sd-pins">
          <h3 class="subtitle">SD SPI BUS</h3>
          <div class="evenly forexport" data-define="SD_HSPI" data-export="RADIO">
            <label class="dsplabel"><input type="radio" class="radio rbox spitype vspi" id="r64" name="sdspitype" data-type="default" data-define="SD_" data-color="bgreen" checked /><span class="checkmark"></span><span id="vspi-text4">VSPI (mosi-23, miso-19, sck-18)</span></label>
            <label class="dsplabel"><input type="radio" class="radio rbox spitype hspi" id="r65" name="sdspitype" data-type="true" data-define="SD_" data-color="bgreen" /><span class="checkmark"></span><span id="hspi-text4">HSPI (mosi-13, miso-12, sck-14)</span></label>
            <label class="dsplabel"><input type="radio" class="radio rbox spitype custom sdcustom" id="r75" name="sdspitype" data-type="true" data-define="SD_" data-color="bgreen" /><span class="checkmark"></span>CUSTOM</label>
          </div>
          <hr class="simple" />
          <div class="evenly forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">CS</span><input type="text" class="textinput" id="i39" data-define="SDC_CS" data-color="bgreen" value="255" maxlength="3"></div>
            <div class="inputwrap hidden sdcustompin"><span class="inputtitle">SCK</span><input type="text" class="textinput exclude sdspic" id="i45" data-define="SDC_SCK" data-color="bgreen" value="255" maxlength="3"></div>
            <div class="inputwrap hidden sdcustompin"><span class="inputtitle">MISO</span><input type="text" class="textinput exclude sdspic" id="i46" data-define="SDC_MISO" data-color="bgreen" value="255" maxlength="3"></div>
            <div class="inputwrap hidden sdcustompin"><span class="inputtitle">MOSI</span><input type="text" class="textinput exclude sdspic" id="i47" data-define="SDC_MOSI" data-color="bgreen" value="255" maxlength="3"></div>
          </div>
        </div>
      </section>
    </div><!-- SDCARD -->
    <!-- RTC -->
    <div id="setup-rtc" class="hidden">
      <hr class="double" />
      <section id="rtc">
        <div class="title"><span>RTC</span></div><div class="help" data-targetid="help-rtc" data-title="rtc">?</div>
        <div class="evenly forexport" data-define="RTC_MODULE" data-export="RADIO">
          <label class="dsplabel"><input type="radio" class="radio rtcradio rbox libs-required" name="rtcmodule" id="r77" data-type="DS3231" data-libs="RTCLib" checked /><span class="checkmark"></span>DS3231</label>
          <label class="dsplabel"><input type="radio" class="radio rtcradio rbox libs-required" name="rtcmodule" id="r78" data-type="DS1307" data-libs="RTCLib" /><span class="checkmark"></span>DS1307</label>
        </div>
        <hr />
        <div class="rtc-pins" id="rtc-pins">
          <div class="evenly forexport" data-export="PINS">
            <div class="inputwrap"><span class="inputtitle">SDA</span><input type="text" class="textinput" id="i48" data-define="RTC_SDA" data-color="yellow" value="255" maxlength="3"></div>
          	<div class="inputwrap"><span class="inputtitle">SCL</span><input type="text" class="textinput" id="i49" data-define="RTC_SCL" data-color="yellow" value="255" maxlength="3"></div>
          </div>
        </div>
      </section>
    </div><!-- RTC -->
    <!-- ETC -->
    <div id="setup-etc" class="hidden">
      <hr class="double" />
      <section id="etc">
        <div class="title"><span>etc.</span></div><div class="help" data-targetid="help-etc" data-title="etc and so on">?</div>
        <div class="evenly">
          <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-etc rbox" id="r66" data-target="etc-led"/><span class="checkmark box"></span>LED PIN</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-etc rbox libs-required" id="r67" data-target="etc-ir" data-libs="IRremoteESP8266" /><span class="checkmark box"></span>IR PIN</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-etc rbox" id="r68" data-target="etc-mute"/><span class="checkmark box"></span>MUTE PIN</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-etc rbox" id="r69" data-target="etc-wake"/><span class="checkmark box"></span>WAKE PIN</label>
          <label class="dsplabel"><input type="checkbox" class="checkbox checkbox-etc rbox" id="r70" data-target="etc-light"/><span class="checkmark box"></span>LIGHT SENSOR</label>
        </div>
        <hr class="simple" />
        <div class="evenly forexport" data-export="PINS">
          <div class="inputwrap hidden" id="etc-led"><span class="inputtitle">led indicator</span><input type="text" class="textinput" id="i40" data-define="LED_BUILTIN" data-color="pink" value="2" maxlength="3">
            <label class="dsplabel hidden esp32-s3 esp32-c3" style="display: block; margin-top: 10px;"><input type="checkbox" class="checkbox rbox" id="r79"/><span class="checkmark box"></span>RGB NEOPIXEL</label></div>
          <div class="inputwrap hidden" id="etc-ir"><span class="inputtitle">ir</span><input type="text" class="textinput" id="i41" data-define="IR_PIN" data-color="pink" value="255" maxlength="3"></div>
          <div class="inputwrap hidden" id="etc-mute"><span class="inputtitle">mute</span><input type="text" class="textinput" id="i42" data-define="MUTE_PIN" data-color="pink" value="255" maxlength="3"></div>
          <div class="inputwrap hidden" id="etc-wake"><span class="inputtitle">wake</span><input type="text" class="textinput" id="i43" data-define="WAKE_PIN" data-color="pink" value="255" maxlength="3"></div>
          <div class="inputwrap hidden" id="etc-light"><span class="inputtitle">light sensor</span><input type="text" class="textinput" id="i44" data-define="LIGHT_SENSOR" data-color="pink" value="255" maxlength="3"></div>
        </div>
      </section>
    </div><!-- ETC -->
    <hr class="double" />
    <div id="submit" class="evenly">
      <div class="button apply" title="Resets all pins to defaults" onclick="resetGPIOsDefault();">reset pins</div>
      <div class="button apply hlbutton" title="Download myoptions.h" onclick="doExport();">get myoptions.h</div>
      <div class="button apply" title="Show connections" onclick="doPreview();">preview</div>
      <div class="button apply" id="docopy" title="Copy to clipboard" onclick="doExport(true);">copy</div>
    </div>
    <div class="href" onclick="getLink();">>> link to this configuration <<</div>
    <div id="footer"></div>
    <button onclick="topFunction()" id="topbtn" class="scrollbutton">&#8593;</button>
    <button onclick="bottomFunction()" id="bottombtn" class="scrollbutton">&#8595;</button>
    <div id="helpwrapper" class="hidden">
      <div id="helpborder">
        <div id="helptitle"></div>
        <div id="helpcontent">
          <div class="helpitem hidden" id="help-ban-pins">
            <p id="ban-pins-info">Auxiliary section that allows you to prohibit the appointment of certain GPIOs when choosing the board type.</p>
            <p>Values in this section are not included in myoptions.h</p>
          </div>
          <div class="helpitem hidden" id="help-setup">
            <p>Here you need to mark the hardware that you want to connect / which is connected.</p>
            <p>Values in this section are not included in myoptions.h</p>
          </div>
          <div class="helpitem hidden" id="help-language">
            <p>Language for the information shown on the display.</p>
            <p>Parameter added to myoptions.h (default value specified):</p>
            <code>
<span>#define L10N_LANGUAGE EN</span>
            </code>
          </div>
          <div class="helpitem hidden" id="help-display">
            <p>Display model. See description/available values in <br />
            <a href="https://github.com/e2002/yoradio/wiki/Available-display-models" target="_blank">https://github.com/e2002/yoradio/wiki/Available-display-models</a></p>
            <p>Parameter added to myoptions.h (default value specified):</p>
            <code>
<span>#define DSP_MODEL         DSP_DUMMY</span>
            </code>
            <p>Nextion displays can work in parallel with another display (or without a display, separately).</p>
            <p>Specify the <strong>[ ]+NEXTION</strong> parameter and ask for a description below.</p>
          </div>
          <div class="helpitem hidden" id="help-display-pins">
            <p>Depending on the selected display type above, its connection options are displayed here.</p>
            <p>If you have any questions about choosing VSPI vs HSPI, please read <a href="https://randomnerdtutorials.com/esp32-spi-communication-arduino/#esp32-spi-pins" target="_blank">this</a> article or leave the default value of this setting.</p>
            <p>Parameters added to myoptions.h (default value specified):</p>
            <p class="title">SPI Displays</p>
            <code>
/*  VSPI PINS.
    SCL(SCK, CLK) must be connected to pin <span id="vspi-sck-pin1">18</span>
    SDA(MOSI, DIN, SDI) must be connected to pin <span id="vspi-mosi-pin1">23</span>  */
/*  HSPI PINS. Set DSP_HSPI to true
    SCL(SCK, CLK) must be connected to pin <span id="hspi-sck-pin1">14</span>
    SDA(MOSI, DIN, SDI) must be connected to pin <span id="hspi-mosi-pin1">13</span>  */
<span>#define DSP_HSPI        false</span>    /*  Use HSPI for display  */
<span>#define TFT_CS          5</span>        /*  SPI CS pin  */
<span>#define TFT_RST         -1</span>       /*  SPI RST pin */
<span>#define TFT_DC          4</span>        /*  SPI DC/RS pin  */
<span>#define BRIGHTNESS_PIN  255</span>      /* BRIGHTNESS Pin  */
            </code>
            <p class="title">I2C Displays</p>
            <code>
<span>#define I2C_SDA         21</span>       /*  I2C SDA pin  */
<span>#define I2C_SCL         22</span>       /*  I2C SCL pin  */
            </code>
            <p class="title">LCD Displays</p>
            <code>
<span>#define LCD_RS          255</span>      /*  RS Pin */
<span>#define LCD_E           255</span>      /*  E Pin  */
<span>#define LCD_D4          255</span>      /*  D4 Pin */
<span>#define LCD_D5          255</span>      /*  D5 Pin */
<span>#define LCD_D6          255</span>      /*  D6 Pin */
<span>#define LCD_D7          255</span>      /*  D7 Pin */
            </code>
          </div>
          <div class="helpitem hidden" id="help-nextion">
            <p>If both parameters are equal to 255, the Nextion display is not used.</p>
            <p>Parameters added to myoptions.h (default value specified):</p>
            <code>
<span>#define NEXTION_RX    255</span>        /*  Nextion RX pin  */
<span>#define NEXTION_TX    255</span>        /*  Nextion TX pin  */
            </code>
          </div>
          <div class="helpitem hidden" id="help-audio">
            <p>This project works with three types of audio decoders: <br /><strong>external I2S DAC, VS1053 SPI DAC</strong> and <strong>ESP32 built-in I2S DAC</strong>.</p>
            <p>Values in this section are not included in myoptions.h</p>
            <p>If you want to generate mono sound, check the <strong>[ ]MONO</strong> option in this section.</p>
            <p>This parameter added to myoptions.h (default value specified):</p>
            <code>
<span>#define PLAYER_FORCE_MONO    false</span>
            </code>
          </div>
          <div class="helpitem hidden" id="help-audio-pins">
            <p>Depending on the selected audio decoder type above, its connection options are displayed here.</p>
            <p>If you have any questions about choosing VSPI vs HSPI, please read <a href="https://randomnerdtutorials.com/esp32-spi-communication-arduino/#esp32-spi-pins" target="_blank">this</a> article or leave the default value of this setting.</p>
            <p>Parameters added to myoptions.h (default value specified):</p>
            <p class="title">VS1053B</p>
            <code>
/*  VS1053 VSPI PINS.
    VS1053 SCK must be connected to pin <span id="vspi-sck-pin2">18</span>
    VS1053 MISO must be connected to pin <span id="vspi-miso-pin2">19</span>
    VS1053 MOSI must be connected to pin <span id="vspi-mosi-pin2">23</span>  */
/*  VS1053 HSPI PINS.
    VS1053 SCK must be connected to pin <span id="hspi-sck-pin2">14</span>
    VS1053 MISO must be connected to pin <span id="hspi-miso-pin2">12</span>
    VS1053 MOSI must be connected to pin <span id="hspi-mosi-pin2">13</span>  */
<span>#define VS_HSPI       false</span>  /*  Use HSPI for VS  */
<span>#define VS1053_CS     255</span>    /*  XCS pin */
<span>#define VS1053_DCS    25</span>     /*  XDCS pin.  */
<span>#define VS1053_DREQ   26</span>     /*  DREQ pin.  */
<span>#define VS1053_RST    -1</span>     /*  XRESET pin. */
            </code>
            <p class="title">External I2S DAC</p>
            <code>
<span>#define I2S_DOUT      27</span>     /*  DIN connection */
<span>#define I2S_BCLK      26</span>     /*  BCLK Bit clock */
<span>#define I2S_LRC       25</span>     /*  WSEL Left Right Clock */
            </code>
            <p class="title">Internal I2S DAC</p>
            <code>
<span>#define I2S_INTERNAL  false</span>  /*  If true - use esp32 internal DAC  */
            </code>
          </div>
          <div class="helpitem hidden" id="help-buttons">
            <p>Specify which device control buttons you would like to use. Up to five control buttons can be assigned + MODE button.</p>
            <p>Values in this section are not included in myoptions.h</p>
            <p>You can set up pins for buttons in the <strong>buttons pins</strong> section below.</p>
          </div>
          <div class="helpitem hidden" id="help-buttons-pins">
            <p>Up to five control buttons can be assigned + MODE button.</p>
            <p>Buttons control logic is described on <a href="https://github.com/e2002/yoradio/blob/main/Controls.md#buttons" target="_blank">this page</a>.</p>
            <p>Parameters added to myoptions.h (default value specified):</p>
            <code>
<span>#define BTN_LEFT              255</span>    /*  VolDown, Prev */
<span>#define BTN_CENTER            255</span>    /*  Play, Stop, Show playlist */
<span>#define BTN_RIGHT             255</span>    /*  VolUp, Next */
<span>#define BTN_UP                255</span>    /*  Prev, Move Up */
<span>#define BTN_DOWN              255</span>    /*  Next, Move Down */
<span>#define BTN_INTERNALPULLUP    true</span>   /*  Enable the weak pull up resistors */

<span>#define BTN_MODE              255</span>    /*  MODE switcher  */
            </code>
          </div>
          <div class="helpitem hidden" id="help-encoders">
            <p>You can connect one or two encoders to control the device.</p>
            <p>Encoder control logic is described on <a href="https://github.com/e2002/yoradio/blob/main/Controls.md#encoders" target="_blank">this page</a>.</p>
            <p>Values in this section are not included in myoptions.h</p>
            <p>You can set up pins for encoders in the <strong>encoders pins</strong> section below.</p>
          </div>
          <div class="helpitem hidden" id="help-encoders-pins">
            <p>Parameters added to myoptions.h (default value specified):</p>
            <code>
/*  ENCODER  */
<span>#define ENC_BTNL              255</span>    /*  Left rotation (S2) */
<span>#define ENC_BTNB              255</span>    /*  Encoder button (KEY) */
<span>#define ENC_BTNR              255</span>    /*  Right rotation (S1) */
<span>#define ENC_INTERNALPULLUP    true</span>   /*  Enable the weak pull up resistors */
<span>#define ENC_HALFQUARD         false</span>  /*  Experiment  with it */

/*  ENCODER2  */
<span>#define ENC2_BTNL             255</span>    /*  Left rotation (S2) */
<span>#define ENC2_BTNB             255</span>    /*  Encoder button (KEY) */
<span>#define ENC2_BTNR             255</span>    /*  Right rotation (S1) */
<span>#define ENC2_INTERNALPULLUP   true</span>   /*  Enable the weak pull up resistors */
<span>#define ENC2_HALFQUARD        false</span>  /*  (true, false, 255) Experiment  with it */
            </code>
          </div>
          <div class="helpitem hidden" id="help-touchscreen">
            <p>Currently two touchscreen controllers are supported - XPT2046 and GT911</p>
            <p>If you have any questions about choosing VSPI vs HSPI, please read <a href="https://randomnerdtutorials.com/esp32-spi-communication-arduino/#esp32-spi-pins" target="_blank">this</a> article or leave the default value of this setting.</p>
            <p>Parameters added to myoptions.h (default value specified):</p>
            <p class="title">Resistive SPI touch screen (XPT2046)</p>
            <code>
/*  TS VSPI PINS.
    CLK must be connected to pin <span id="vspi-sck-pin3">18</span>
    DIN must be connected to pin <span id="vspi-mosi-pin3">23</span>
    DO  must be connected to pin <span id="vspi-miso-pin3">19</span>
    IRQ - not connected */
/*  TS HSPI PINS.
    CLK must be connected to pin <span id="hspi-sck-pin3">14</span>
    DIN must be connected to pin <span id="hspi-mosi-pin3">13</span>
    DO  must be connected to pin <span id="hspi-miso-pin3">12</span>
    IRQ - not connected */
<span>#define TS_CS     255</span>    /*  Touch screen CS pin  */
<span>#define TS_HSPI   false</span>  /*  Use HSPI for Touch screen  */
            </code>
            <p class="title">Capacitive I2C touch screen (GT911)</p>
            <code>
<span>#define TS_SDA                33</span>
<span>#define TS_SCL                32</span>
<span>#define TS_INT                21</span>
<span>#define TS_RST                25</span>
            </code>
            <p class="title">The default value for TS_MODEL</p>
            <code>
<span>#define TS_MODEL              TS_MODEL_UNDEFINED</span>
            </code>
          </div>
          <div class="helpitem hidden" id="help-sdcard">
            <p>If you have any questions about choosing VSPI vs HSPI, please read <a href="https://randomnerdtutorials.com/esp32-spi-communication-arduino/#esp32-spi-pins" target="_blank">this</a> article or leave the default value of this setting.</p>
            <p>Parameters added to myoptions.h (default value specified):</p>
            <code>
/*  MISO is the same as D0, MOSI is the same as D1 */
/*  SD VSPI PINS.
    SD SCK must be connected to pin <span id="vspi-sck-pin4">18</span>
    SD MISO must be connected to pin <span id="vspi-miso-pin4">19</span>
    SD MOSI must be connected to pin <span id="vspi-mosi-pin4">23</span>  */
/*  SD HSPI PINS.
    SD SCK must be connected to pin <span id="hspi-sck-pin4">14</span>
    SD MISO must be connected to pin <span id="hspi-miso-pin4">12</span>
    SD MOSI must be connected to pin <span id="hspi-mosi-pin4">13</span>  */
/*  SD CUSTOM SPI.
    #define SD_SPIPINS	PIN, PIN, PIN	/* SCK, MISO, MOSI  */
<span>#define SD_HSPI       false</span>
<span>#define SDC_CS        255</span>    /* SDCARD CS pin */
            </code>
          </div>
          <div class="helpitem hidden" id="help-rtc">
          	<p>Two RTC modules are currently supported - DS3231 and DS1307</p>
            <p>Parameters added to myoptions.h (default value specified):</p>
            <code>
<span>#define RTC_MODULE      RTC_MODULE_UNDEFINED</span>
<span>#define RTC_SDA         255</span>
<span>#define RTC_SCL         255</span>
            </code>
          </div>
          <div class="helpitem hidden" id="help-etc">
            <p>Settings for built-in LED, IR receiver and other pins.</p>
            <p>Parameters added to myoptions.h (default value specified):</p>
            <code>
<span>#define LED_BUILTIN     255</span>    /*  Onboard LED Pin */
<span>#define USE_BUILTIN_LED false</span>  /*  Cancels Onboard LED Pin */
<span>#define LED_BUILTIN_S3  255</span>    /*  Neopixel RGB LED (must be used with USE_BUILTIN_LED false) */
<span>#define IR_PIN          255</span>    /* <a href="https://github.com/e2002/yoradio/blob/main/Controls.md#ir-receiver" target="_blank"><u>More about IR Receiver</u></a> */
<span>#define MUTE_PIN        255</span>    /*  MUTE Pin */
<span>#define WAKE_PIN        255</span>    /*  Wake Pin (for manual wakeup from sleep mode) */
/* can match with BTN_XXXX, ENC_BTNB, ENC2_BTNB.  ESP32 must be one of: 0,2,4,12,13,14,15,25,26,27,32,33,34,35,36,39 */
<span>#define LIGHT_SENSOR    255</span>    /*  Light sensor  */
            </code>
            <p>Settings currently not processed by the generator (you can specify them manually in the finished file myoptions.h:</p>
            <p>Add them only if there is a real need.</p>
            <p>Parameters added to myoptions.h (default value specified):</p>
            <code>
<span>#define LED_INVERT    false</span>    /*  Invert Onboard LED? */
<span>#define MUTE_VAL    HIGH</span>   /*  Write this to MUTE_PIN when player is stopped */
/*  Autobacklight function. See options.h for exsample  */
<span>#define AUTOBACKLIGHT(x)  *function*</span>
/* IR_TIMEOUT. See kTimeout description in <a href="https://github.com/crankyoldgit/IRremoteESP8266/blob/master/examples/IRrecvDumpV2/IRrecvDumpV2.ino" target="_blank">IRremoteESP8266 exsample</a>  */
<span>#define IR_TIMEOUT      80 </span>        

<span>#define BTN_LONGPRESS_LOOP_DELAY    200</span>  /*  Delay between calling DuringLongPress event */
<span>#define BTN_CLICK_TICKS    300</span> /*  Event Timing https://github.com/mathertel/OneButton#event-timing */
<span>#define BTN_PRESS_TICKS    500</span> /*  Event Timing https://github.com/mathertel/OneButton#event-timing */
            </code>
          </div>
        </div>
        <div id="helpfooter" class="evenly"><div class="button apply hlbutton" onclick="doneHelp();">ок</div></div>
      </div>
    </div>
  </div><!--content-->
</body>
<script>
  var atimeout;
  var isOptionBanPins = false;
  var resetGPIOs = false;
  var esptype = 'ESP32';
  //window.addEventListener('load', onLoad); // this will cause version number to be displayed twice when running locally but only once on Github Pages
  
  // This bit loads various files dynamically, depending on board selected, including default values for script
  document.addEventListener('DOMContentLoaded', () => { // Ensure the DOM is fully loaded
    const boardSelect = document.getElementById('board-select');
    //loadContent('ESP32-DevKit-V1_38Pin'); // Default selection when page loads
    boardSelect.removeEventListener('change', handleBoardChange); // Cleanup
    boardSelect.addEventListener('change', handleBoardChange); // Attach listener
    async function handleBoardChange() {
      const board = boardSelect.value;
      loadContent(board);
    }
    document.title = document.title+" - "+GVERSION;
    let ttl = document.getElementById("pagetitle");
    ttl.innerText = document.title;
    document.getElementById("footer").innerHTML = document.title + '<br /><a href="https://github.com/e2002/yoradio/" target="_blank">project homepage</a>';
    initCheckboxes();
    initTextInputs();
    initHelp();
    loadConfigFromUrl();
    loadAlert();
  })
  function loadContent(board) {
    const boardArea = document.getElementById('board-area');
    const espBoardArea = document.getElementById('esp-board-area');
    const pinoutImg = document.getElementById('board-pinout-img');
    if (pinoutImg) {
    const jpgPath = `${board}/${board}-Board.jpg?timestamp=${new Date().getTime()}`; // load jpg with cache-busting
    fetch(jpgPath, { method: 'HEAD' })
      .then(response => {
        if (response.ok) {
          pinoutImg.src = jpgPath; // Use JPG if found
        } else {
          console.warn('Pinout image not found.');
        }
      })
      .catch(() => {
        console.error('Error loading pinout image.');
      });
    }
    // Choose the MCU type, esptype variable will be used for generating as well
    if (board.includes('ESP32-S3')) { esptype = 'ESP32-S3'; }
      else if (board.includes('ESP32-C3')) { esptype = 'ESP32-C3'; } // use this line if adding new MCU types
      else { esptype = 'ESP32'; }
    // Now let's hide/unhide classes for these MCU types
    const elements = document.querySelectorAll('[class*="esp32"]');
    elements.forEach(element => {
    // If the element's class matches the selected esptype, show it
      if (element.classList.contains(esptype.toLowerCase())) {
        element.classList.remove('hidden');
      } else { // otherwise hide it and clear any inputs that might be inside
        element.classList.add('hidden');
        element.querySelectorAll('input').forEach(input => {
          if (input.type === 'checkbox' || input.type === 'radio') {
            input.checked = false;
          } else if (input.type === 'text') {
            input.value = '';
          } else if (input.tagName === 'SELECT') {
            input.selectedIndex = 0;
          }
        });
      }
    });
    fetch(`${board}/${board}-Preview.html?timestamp=${new Date().getTime()}`) // load html with cache-busting
      .then(response => {
        if (!response.ok) {
          throw new Error('Board files error.');
        }
        return response.text();
      })
      .then(data => {
        boardArea.innerHTML = data; // Insert HTML content into board-area
        const newCSS = document.createElement('link');
        newCSS.rel = 'stylesheet';
        newCSS.href = `${board}/${board}-Preview.css?timestamp=${new Date().getTime()}`; // load css with cache-busting
        newCSS.id = 'board-css';
        const oldCSS = document.getElementById('board-css');
        if (oldCSS) {
          oldCSS.onload = null;  // Clear any pending load handlers
          oldCSS.onerror = null; // Clear any error handlers
          oldCSS.remove();       // Remove it cleanly
        }
        document.head.appendChild(newCSS); // Add the new CSS
        const newScript = document.createElement('script'); // add Javascript dynamically
        newScript.src = `${board}/${board}-Pins.js?timestamp=${new Date().getTime()}`; // load js with cache-busting
        newScript.id = 'board-js';
        const oldScript = document.getElementById('board-js');
        if (oldScript) {
          oldScript.onload = null;  // Clear any pending load handlers
          oldScript.onerror = null; // Clear any error handlers
          oldScript.remove();       // Remove it cleanly
        }
        newScript.onload = () => { // Wait until the new JS is loaded
          // Update input values based on defaultValues from the loaded script
          const inputs = document.querySelectorAll('input[data-define]'); // Select inputs with data-define attribute
          inputs.forEach(input => {
            const defineKey = input.getAttribute('data-define'); // Get the key from data-define
            if (typeof defaultValues !== 'undefined' && defaultValues.hasOwnProperty(defineKey)) { // Check if defaultValues exists and has the key
              const newValue = defaultValues[defineKey]; // Get the value from the external script
              if (resetGPIOs ) { input.value = newValue; } // Update input value if reset flag on (requires a click)
              //if (newValue !== 255 && resetGPIOs) { input.value = newValue; } // Update input value if reset clicked
            }
          });
          // Replace VSPI & HSPI text & pin numbers dynamically
          updateSPIText('vspi', vspiGPIOs);
          updateSPIText('hspi', hspiGPIOs);
          //resetGPIOs = false;
          resetGPIOs = true;
        };
        document.body.appendChild(newScript); // Add new JS
      })
      .catch(error => {
        console.error('Error loading board content:', error);
        boardArea.innerHTML = '<p>Error loading board content.</p>'; // Display error message
      });
    fetch(`${esptype}.html`) // Load board-information content
      .then(response => {
        if (!response.ok) {
          throw new Error('Board information files error.');
        }
        return response.text();
      })
      .then(data => {
        espBoardArea.innerHTML = data; // Insert HTML into board-information
        const newEspScript = document.createElement('script'); // Add Javascript dynamically for board-information
        newEspScript.src = `${esptype}.js?timestamp=${new Date().getTime()}`; // load js with cache-busting
        newEspScript.id = 'esp-board-js';
        const oldEspScript = document.getElementById('esp-board-js');
        if (oldEspScript) {
          oldEspScript.onload = null;  // Clear any pending load handlers
          oldEspScript.onerror = null; // Clear any error handlers
          oldEspScript.remove();       // Remove it cleanly
        }
        newEspScript.onload = () => { // Wait until the new JS is loaded - this section replaces text
          if (typeof BanPinsInfo !== 'undefined' && noBanPinsLabel !== 'undefined' && typeof BanPinsLabel !== 'undefined') {
            document.getElementById('ban-pins-info').textContent = BanPinsInfo;
            document.getElementById('no-ban-pins-label').textContent = noBanPinsLabel;
            document.getElementById('ban-pins-label').textContent = BanPinsLabel;
          }
        };
        document.body.appendChild(newEspScript); // Add new JS
      })
      .catch(error => {
        console.error('Error loading ESP board content:', error);
        espBoardArea.innerHTML = '<p>Error loading ESP board content.</p>';
      });
  }
  function updateSPIText(spiType, gpioArray) {
    const spiTextElements = document.querySelectorAll(`[id^='${spiType}-text']`); // Update SPI labels
    const pinNames = ['sck', 'miso', 'mosi']; // Pin labels
    if (typeof gpioArray !== 'undefined') {
      const unavailable = gpioArray.some(pin => pin === 255); // Check for unavailable pins
      // If unavailable, hide the SPI option or revert to VSPI
      const spiInputs = document.querySelectorAll(`input.spitype.${spiType}`); // SPI radio buttons
      spiInputs.forEach(input => {
        if (unavailable) {
          input.disabled = true; // Disable the input
          input.checked = false; // Uncheck if selected
          input.closest('label').style.display = 'none'; // Hide the label
        } else {
          input.disabled = false; // Enable the input
          input.closest('label').style.display = ''; // Show the label
        }
      });
      // Update text for SPI labels
      const text = unavailable
        ? `${spiType.toUpperCase()} (not available)`
        : `${spiType.toUpperCase()} (sck-${gpioArray[0]}, miso-${gpioArray[1]}, mosi-${gpioArray[2]})`;
        spiTextElements.forEach(el => el.textContent = text);
      // Update individual pin numbers
      pinNames.forEach((pin, index) => {
        const pinElements = document.querySelectorAll(`[id^='${spiType}-${pin}-pin']`);
        pinElements.forEach(el => {
          el.textContent = gpioArray[index] === 255 
          ? 'n/a' // Replace unavailable pin
          : gpioArray[index]; // Replace with the actual pin number
        });
      });
      // Auto-select VSPI if HSPI is unavailable and currently selected
      if (unavailable) {
        const vspiInput = document.querySelector('input.spitype.vspi');
        if (vspiInput) vspiInput.checked = true; // Set VSPI as selected
      }
    }
  }
  function boardViewClick(){
    const pinoutArea = document.getElementById("board-pinout-area");
    const button = document.getElementById("board-pinout-button");
    const isHidden = pinoutArea.classList.toggle("hidden");
    button.textContent = isHidden ? "Show Board Pinout" : "Hide Board Pinout";
  }
  function resetGPIOsDefault(){
    resetGPIOs = true;
    const boardSelect = document.getElementById('board-select');
    //const board = boardSelect.value;
    //loadContent(board);
    //boardSelect.value = board; // Set dropdown value
    boardSelect.dispatchEvent(new Event('change')); // Simulate a change event
  }
  function donePreview(){
    document.getElementById('preview').classList.add('hidden');;
    let elements = document.getElementsByClassName('preview-pin');
    for (var i = elements.length -1; i >= 0; i--) {
      if(!elements[i].classList.contains("preview-pin-static")) elements[i].remove();
    }
  }
  function doPreview(){
    if(!validatePins()) {
      doAlert("error", "Error filling values");
      return;
    }
    let pinOptionBanPins = document.getElementsByClassName("preview-pin-optionban");
    for (var i = pinOptionBanPins.length -1; i >= 0; i--) {
      pinOptionBanPins[i].parentNode.classList.remove("add");
      pinOptionBanPins[i].remove();
    }
    let movableDynamic = document.getElementsByClassName("movable-dynamic");
    for (var i = 0; i < movableDynamic.length; i++) {
      movableDynamic[i].classList.add("movable");
    }
    if (isOptionBanPins) {
      if (typeof BanPins !== 'undefined' && Array.isArray(BanPins)) { // Ensure BanPins is defined (in case it's not loaded yet)
        BanPins.forEach(pin => {
          let targetId = document.getElementById("gpio-" + pin);
          if (targetId) {
            let previewPin = document.createElement("div");
            previewPin.classList.add("preview-pin", "preview-pin-dis", "preview-pin-static", "preview-pin-optionban");
            previewPin.innerHTML = "X";
            targetId.appendChild(previewPin);
            targetId.classList.remove("movable");
          }
        });
      } else {
        console.error('BanPins is not defined or is not an array');
      }
    }
    let spitypes = document.getElementsByClassName("spitype");
    
    //
    for (var i = 0; i < spitypes.length; i++) {
      if (spitypes[i].offsetParent === null) continue; // Skip hidden elements
      let spiPins = [];
      const spiNames = ["SCK", "MISO", "MOSI"];
      if (spitypes[i].checked) { // Handle checked SPI options
        if (spitypes[i].classList.contains("vspi")) {
          spiPins = vspiGPIOs; // Use predefined VSPI pins
        } else if (spitypes[i].classList.contains("custom")) {

        } else {
          spiPins = hspiGPIOs; // Use predefined HSPI pins
        }
      }
      const unavailable = spiPins.some(pin => pin === 255); // Check for unavailable pins
      let color = "preview-" + spitypes[i].getAttribute("data-color");
      for (var k = 0; k < spiPins.length; k++) {
        let targetId = document.getElementById("gpio-" + spiPins[k]);
        if (unavailable || spiPins[k] === 255) {
          // Skip unavailable pins
          continue;
        }
        let previewPin = document.createElement("div"); // Create preview pin element
        previewPin.classList.add("preview-pin");
        previewPin.classList.add(color);
        previewPin.innerHTML = spitypes[i].getAttribute("data-define") + spiNames[k] + "&nbsp;[" + spiPins[k] + "]";
        previewPin.id = "preview-static-" + k;
        // Append preview to target element
        targetId.appendChild(previewPin);
        targetId.classList.remove("movable");
      }
    }

    let textinputs = document.getElementsByClassName("textinput");
    for (var i = 0; i < textinputs.length; i++) {
      if(textinputs[i].offsetParent === null) continue;
      if(textinputs[i].value!="" && textinputs[i].value!="255"){
        let targetId=document.getElementById("gpio-"+textinputs[i].value);
        if(textinputs[i].value=="-1") targetId=document.getElementById("gpio-en");
        if(targetId){
          let color = "preview-" + textinputs[i].getAttribute("data-color");
          let previewPin = document.createElement("div");
          previewPin.classList.add("preview-pin");
          previewPin.classList.add(color);
          previewPin.setAttribute("data-parent", textinputs[i].id);
          previewPin.setAttribute("data-value", textinputs[i].value);
          previewPin.setAttribute("data-define", textinputs[i].getAttribute("data-define"));
          previewPin.innerHTML = textinputs[i].getAttribute("data-define") + "&nbsp;["+textinputs[i].value+"]";
          previewPin.id = "preview-"+i;
          targetId.appendChild(previewPin);
        }
      }else{
        let targetId=document.getElementById("preview-pins-unused");
        let color = "preview-" + textinputs[i].getAttribute("data-color");
          let previewPin = document.createElement("div");
          previewPin.classList.add("preview-pin");
          previewPin.classList.add(color);
          previewPin.setAttribute("data-parent", textinputs[i].id);
          previewPin.setAttribute("data-value", textinputs[i].value);
          previewPin.setAttribute("data-define", textinputs[i].getAttribute("data-define"));
          previewPin.innerHTML = textinputs[i].getAttribute("data-define");
          previewPin.id = "preview-"+i;
          targetId.appendChild(previewPin);
      }
    }
    document.getElementById('preview').classList.remove('hidden');
    
    let movable = document.getElementsByClassName("movable");
    for (var i = 0; i < movable.length; i++) {
      let draggable = movable[i].getElementsByClassName("preview-pin")[0];
      if(draggable) draggable.setAttribute("draggable", true);
    }
    movable = document.getElementById("preview-pins-unused").getElementsByClassName("preview-pin");
    for (var i = 0; i < movable.length; i++) {
      movable[i].setAttribute("draggable", true);
    }
    document.getElementById("preview").style.paddingLeft=document.getElementById("preview-pins-unused").offsetWidth + 20 + "px";
  }
  function dontAlert(){
    document.getElementById("alert").setAttribute("class", "hidden");
    document.getElementById("alert").innerHTML = "";
    if(atimeout) clearTimeout(atimeout);
  }
  function doAlert(atype, atext, atimeout=7000){
    document.getElementById("alert").setAttribute("class", atype);
    document.getElementById("alert").innerHTML = atext;
    atimeout = setTimeout(dontAlert, atimeout);
  }
  function saveAlert(atype, atext){
    localStorage.setItem('alert', atext);
    localStorage.setItem('atype', atype);
  }
  function loadAlert(){
    let salert = localStorage.getItem('alert');
    if(salert){
      let satype = localStorage.getItem('atype');
      doAlert(satype, salert);
      localStorage.removeItem('alert');
      localStorage.removeItem('atype');
    }
  }
  function dspRadioClick(){
    let target=this.getAttribute('data-target');
    document.getElementById("display-pins").classList.add("hidden");
    document.getElementById("pins-spi").classList.add("hidden");
    document.getElementById("pins-i2c").classList.add("hidden");
    document.getElementById("pins-lcd").classList.add("hidden");
    if(target!="dmy") document.getElementById("display-pins").classList.remove("hidden");
    if(target=="spi") document.getElementById("pins-spi").classList.remove("hidden");
    if(target=="i2c") document.getElementById("pins-i2c").classList.remove("hidden");
    if(target=="lcd") document.getElementById("pins-lcd").classList.remove("hidden");
    document.getElementById("pins-7735").classList.add("hidden");
    if(this.hasAttribute('data-st')) {
      document.getElementById("pins-7735").classList.remove("hidden");
      document.getElementsByClassName("initr-blacktab")[0].click();
    }
  }
  function nextionBoxClick(){
    if(this.checked){
      document.getElementById("nextion").classList.remove("hidden");
    }else{
      document.getElementById("nextion").classList.add("hidden");
    }
  }
  function buttonsUseClick(){
    let hiddenradio = document.getElementById("scontent-buttons").getElementsByClassName("hiddenradio");
    let  pinbuttons = document.getElementsByClassName(" pinbuttons");
    if(this.checked){
      document.getElementById("buttons-pins").classList.remove("hidden");
      for (var i = 0; i < hiddenradio.length; i++) {
        hiddenradio[i].classList.remove("hidden");
      }
      for (var i = 0; i < pinbuttons.length; i++) {
        if(document.getElementsByClassName("five-buttons")[0].checked){
          pinbuttons[i].classList.remove("hidden");
        }else{
          if(pinbuttons[i].classList.contains("threebuttons")) pinbuttons[i].classList.remove("hidden");
        }
      }
    }else{
      if(!document.getElementsByClassName("mode-button")[0].checked) document.getElementById("buttons-pins").classList.add("hidden");
      for (var i = 0; i < hiddenradio.length; i++) {
        hiddenradio[i].classList.add("hidden");
      }
      for (var i = 0; i < pinbuttons.length; i++) {
         pinbuttons[i].classList.add("hidden");
      }
    }
  }
  function buttonsModeClick(){
    if(this.checked) document.getElementById("modebutton").classList.remove("hidden"); else document.getElementById("modebutton").classList.add("hidden");
    let controlButtons = document.getElementsByClassName("control-buttons")[0];
    if(!controlButtons.checked) document.getElementById("buttons-pins").classList.remove("hidden");
    if(!this.checked && !controlButtons.checked) document.getElementById("buttons-pins").classList.add("hidden");
  }
  function audioRadioClick(){
    let target=this.getAttribute('data-target');
    document.getElementById("audio-pins-spi-wrap").classList.add("hidden");
    document.getElementById("audio-pins-i2s").classList.add("hidden");
    document.getElementById("audio-pins").classList.remove("hidden");
    if(target=="int") document.getElementById("audio-pins").classList.add("hidden");
    if(target=="i2s") document.getElementById("audio-pins-i2s").classList.remove("hidden");
    if(target=="vs") document.getElementById("audio-pins-spi-wrap").classList.remove("hidden");
  }
  function buttonsRadioClick(){
    let target=this.getAttribute('data-target');
    let fbuttons = document.getElementsByClassName("fivebuttons");
    for (var i = 0; i < fbuttons.length; i++) {
      if(target=="treebuttons") fbuttons[i].classList.add("hidden"); else fbuttons[i].classList.remove("hidden");
    }
  }
  function encoderCheckboxClick(){
    let ebx1 = document.getElementsByClassName("encoder-box1")[0];
    let ebx2 = document.getElementsByClassName("encoder-box2")[0];
    let epinssection = document.getElementById("encoders-pins");
    if(ebx1.checked || ebx2.checked) epinssection.classList.remove("hidden"); else epinssection.classList.add("hidden");
    if(ebx1.checked) document.getElementById("epins1").classList.remove("hidden"); else document.getElementById("epins1").classList.add("hidden");
    if(ebx2.checked) document.getElementById("epins2").classList.remove("hidden"); else document.getElementById("epins2").classList.add("hidden");
    if(ebx1.checked && ebx2.checked) document.getElementById("ehr").classList.remove("hidden"); else document.getElementById("ehr").classList.add("hidden");
  }
  function setupCheckboxClick(){
    let target = this.getAttribute("data-target");
    let targetId = document.getElementById(target);
    if(targetId) targetId.classList.toggle("hidden");
  }
  function sdRadioClick(){
  	let sdcustom=this.classList.contains('sdcustom');
  	let sdcustompins = document.getElementsByClassName("sdcustompin");
  	for (var i = 0; i < sdcustompins.length; i++) {
      if(!sdcustom) sdcustompins[i].classList.add("hidden"); else sdcustompins[i].classList.remove("hidden");
    }
  }
  function initCheckboxes(){
    let sdsp = document.getElementById("scontent-displays");
    let elements = sdsp.getElementsByClassName("radio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', dspRadioClick, false);
    }
    document.getElementsByClassName("plus-nextion")[0].addEventListener('click', nextionBoxClick, false);
    document.getElementsByClassName("control-buttons")[0].addEventListener('click', buttonsUseClick, false);
    document.getElementsByClassName("mode-button")[0].addEventListener('click', buttonsModeClick, false);
    sdsp = document.getElementById("scontent-audio");
    elements = sdsp.getElementsByClassName("radio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', audioRadioClick, false);
    }
    sdsection = document.getElementById("sdcard");
    elements = sdsection.getElementsByClassName("radio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', sdRadioClick, false);
    }
    sdsp = document.getElementById("scontent-buttons");
    elements = sdsp.getElementsByClassName("radio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', buttonsRadioClick, false);
    }
    elements = document.getElementsByClassName("encodercheckbox");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', encoderCheckboxClick, false);
    }
    elements = document.getElementsByClassName("checkbox-setup");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', setupCheckboxClick, false);
    }
    elements = document.getElementsByClassName("dspradio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', function(){
        document.getElementById("dsp-rotate").classList.add("hidden");
        document.getElementById("dsp-invert").classList.add("hidden");
        if(this.checked && this.hasAttribute("data-rotate")) document.getElementById("dsp-rotate").classList.remove("hidden");
        if(this.checked && this.hasAttribute("data-invert")) document.getElementById("dsp-invert").classList.remove("hidden");
      }, false);
    }
    elements = document.getElementsByClassName("tsradio");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', function(){
        let target = this.getAttribute("data-target");
        let tspins = document.getElementsByClassName("ts-pins");
        for (var k = 0; k < tspins.length; k++) {
          tspins[k].classList.add("hidden");
        }
        document.getElementById(target).classList.remove("hidden");
      }, false);
    }
    elements = document.getElementsByClassName("checkbox-etc");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', function(){
        let target = this.getAttribute("data-target");
        if(this.checked) document.getElementById(target).classList.remove("hidden"); else document.getElementById(target).classList.add("hidden");
      }, false);
    }
  }
  function validatePins(){
    let elements = document.getElementsByClassName("textinput");
    var hspibusy = false;
    var vspibusy = false;
    isOptionBanPins = document.getElementsByClassName("espmodule")[1].checked;
    for (var i = 0; i < elements.length; i++) {
      elements[i].classList.remove("error");
      elements[i].classList.remove("conflict");
      elements[i].classList.remove("invalid");
      elements[i].classList.remove("optionban");
      elements[i].classList.remove("vspi");
      elements[i].classList.remove("hspi");
    }
    let sdspic=document.getElementsByClassName("sdspic");
		for (var sd = 0; sd < sdspic.length; sd++) {
			if(sdspic[sd].offsetParent === null) continue;
			if(sdspic[sd].value==""){
				sdspic[sd].classList.add("error");
        sdspic[sd].scrollIntoView({behavior: "smooth", block: "center", inline: "nearest"});
        return false;
			}
		}
    let spitype = document.getElementsByClassName("spitype");
    for (var i = 0; i < spitype.length; i++) {
      if(spitype[i].offsetParent === null) continue;
      if(spitype[i].checked){
        if(spitype[i].classList.contains("vspi")) vspibusy=true; else hspibusy=true;
        //if(spitype[i].classList.contains("hspi")) hspibusy=true;
        if(spitype[i].classList.contains("custom")) { vspibusy=false; hspibusy=false; }
      }
    }
    for (var i = 0; i < elements.length; i++) {
      if(elements[i].offsetParent === null || elements[i].value=="" || elements[i].value=="-1" || elements[i].value=="255") continue;
      if(hspibusy==true && hspiGPIOs.includes(parseInt(elements[i].value))){
        elements[i].classList.add("error");
        elements[i].classList.add("hspi");
        elements[i].scrollIntoView({behavior: "smooth", block: "center", inline: "nearest"});
        return false;
      }
      if(vspibusy==true && vspiGPIOs.includes(parseInt(elements[i].value))){
        elements[i].classList.add("error");
        elements[i].classList.add("vspi");
        elements[i].scrollIntoView({behavior: "smooth", block: "center", inline: "nearest"});
        return false;
      }
      var validGPIOsFiltered = isOptionBanPins?validGPIOs.filter(function(value) { return !BanPins.includes(value); }):validGPIOs;
      let intVal = parseInt(elements[i].value);
      if(!validGPIOsFiltered.includes(intVal)) {
        elements[i].classList.add("error");
        elements[i].classList.add((intVal==35 || intVal==36 || intVal==37)?"optionban":"invalid");
        elements[i].scrollIntoView({behavior: "smooth", block: "center", inline: "nearest"});
        return false;
      }
      for (var k = 0; k < elements.length; k++) {
        if(elements[k].offsetParent === null || elements[k].value=="" || elements[i].value=="-1" || elements[i].value=="255") continue;
        if(elements[i]==elements[k]) continue;
        if(elements[i].value==elements[k].value){
          elements[i].classList.add("error");
          elements[i].classList.add("conflict");
          elements[k].classList.add("error");
          elements[k].classList.add("conflict");
          elements[i].scrollIntoView({behavior: "smooth", block: "center", inline: "nearest"});
          return false;
        }
      }
    }
    return true;
  }
  function initTextInputs(){
    let elements = document.getElementsByClassName("textinput");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('focus', function(){this.classList.remove("error");this.select();}, false);
      elements[i].addEventListener('blur', function(){
        validatePins();
      }, false);
    }
  }
  function loadConfigFromUrl(){
    let params = (new URL(document.location)).searchParams;
    let board = params.get('b');
    let boardSelect = document.getElementById('board-select');
    let usedDefaultBoard = false;
    let loadedWithErrors = false;
    if (boardSelect) {
      if (!board || ![...boardSelect.options].some(opt => opt.value === board)) {
        board = 'ESP32-DevKit-V1_38Pin'; // Fallback
        usedDefaultBoard = true;
      }
      boardSelect.value = board; // Set dropdown value
      loadContent(board);
    }
    let rr = params.get('r');
    let ii = params.get('i');
    let vv = params.get('v');
    if(!rr || !ii || !vv) return;
    try {
      var datarr = JSON.parse("["+rr+"]");
      var dataii = JSON.parse("["+ii+"]");
      var datavv = JSON.parse("[\""+vv.replace(/,/g, '","')+"\"]");
    } catch (error) {
      console.error(error);
      doAlert("error", error);
      return;
    }
    if(typeof datarr !== 'undefined'){
      let cboxes = document.getElementsByClassName("checkbox");
      for (var i = 0; i < cboxes.length; i++) {
        try {
          let aid = parseInt(cboxes[i].id.substr(1));
          if(datarr.includes(aid) && !cboxes[i].checked) cboxes[i].click();
          if(!datarr.includes(aid) && cboxes[i].checked) cboxes[i].click();
        } catch (error) {
          console.error(`Checkbox error at index ${i}:`, error);
          loadedWithErrors = true; // Flag the error
        }
      }
      let rboxes = document.getElementsByClassName("radio");
      for (var i = 0; i < rboxes.length; i++) {
        try {
          let aid = parseInt(rboxes[i].id.substr(1));
          if(datarr.includes(aid)) rboxes[i].click();
        } catch (error) {
          console.error(`Radio button error at index ${i}:`, error);
          loadedWithErrors = true; // Flag the error
        }
      }
      for (var i = 0; i < dataii.length; i++) {
        try {
          document.getElementById("i"+dataii[i]).value = datavv[i].substr(0,3);
        } catch (error) {
          console.error(`Input field error at index ${i}:`, error);
          loadedWithErrors = true; // Flag the error
        }
      }
    }
    if (loadedWithErrors && usedDefaultBoard) {
      doAlert("error", "Configuration loaded with some errors. Using default board: ESP32-DevKit-V1 (38Pin).");
    } else if (loadedWithErrors && !usedDefaultBoard ) {
      doAlert("error", "Configuration loaded with some errors.");
    } else if (!loadedWithErrors && usedDefaultBoard ) {
      doAlert("warn", "Board not loaded correctly. Using default: ESP32-DevKit-V1 (38Pin).");
    } else {
      doAlert("info", "Configuration loaded successfully!");
    }
  }
  function initHelp(){
    let elements = document.getElementsByClassName("help");
    for (var i = 0; i < elements.length; i++) {
      elements[i].addEventListener('click', function(){
        document.getElementById("helptitle").innerHTML = this.getAttribute("data-title");
        let target = document.getElementById(this.getAttribute("data-targetid"));
        if(target) target.classList.remove("hidden");
        document.getElementById("helpwrapper").classList.remove("hidden");
      });
    }
  }
  function doneHelp(){
    document.getElementById("helpwrapper").classList.add("hidden");
    let items = document.getElementsByClassName("helpitem");
    for (var i = 0; i < items.length; i++) {
      items[i].classList.add("hidden");
    }
  }
  function topFunction(){
    window.scrollTo({
      top: 0,
      left: 0,
      behavior: 'smooth'
    });
  }
  function bottomFunction(){
    window.scrollTo({
      top: document.body.scrollHeight,
      left: 0,
      behavior: 'smooth'
    });
  }
  function getLink(doreturn=false){
    let elements = document.getElementsByClassName("rbox");
    let rr = '';
    let vv = '';
    let ii = '';
    for (var i = 0; i < elements.length; i++) {
      if(elements[i].checked && elements[i].offsetParent !== null){
        rr += elements[i].id.substr(1)+",";
      }
    }
    rr = rr.slice(0, -1);
    elements = document.getElementsByClassName("textinput");
    for (var i = 0; i < elements.length; i++) {
      if(elements[i].value!="" && elements[i].offsetParent !== null){
        ii += elements[i].id.substr(1)+",";
        vv += elements[i].value+",";
      }
    }
    ii = ii.slice(0, -1);
    vv = vv.slice(0, -1);
    board = document.getElementById('board-select').value;
    let out = `b=${board}&r=${rr}&i=${ii}&v=${vv}`;
    if(debug) console.log(out);
    let newlink = window.location.href.split('?')[0]+'?'+out;
    if(doreturn) return newlink;
    if(window.location.href.substr(0,4)!="http" && !debug){
      saveAlert("warning", "This is a local version of the page, the link is available only to you.");
      window.location.href = newlink;
      return; 
    }
    navigator.clipboard.writeText(newlink).then(function() {
      saveAlert("info", "Link copied to clipboard!");
      window.scrollTo({top: 0, left: 0, behavior: 'smooth'});
      window.onscroll = e => {
        let currentScrollOffset = window.pageYOffset || document.documentElement.scrollTop;
        if (currentScrollOffset === 0) {
          window.location.href = newlink;
          window.onscroll = null;
        }
      }
    }, function(err) {
      doAlert("error", "Could not copy text");
    });
  }
  function downloadFile(filename, text) {
    var element = document.createElement('a');
    element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
    element.setAttribute('download', filename);
    element.style.display = 'none';
    document.body.appendChild(element);
    element.click();
    document.body.removeChild(element);
  }
  function libsRequired(){
    let out = "";
    let adafruit = false;
    let lr = document.getElementsByClassName("libs-required");
    let tsxpt = document.getElementsByClassName("touchscreen-xpt")[0];
    /* Here goes! */
    for (var i = 0; i < lr.length; i++) {
      if(lr[i].offsetParent === null) continue;
      if(!lr[i].checked) continue;
      if(lr[i].classList.contains("adafruit") && !adafruit){
        out += "Adafruit GFX Library, ";
        console.log(lr[i].getAttribute("data-type"));
        adafruit = true;
      }
      let libs = lr[i].getAttribute("data-libs");
      if(!libs) continue;
      if(out.includes(libs)) continue;
      out += libs + ", ";
    }
    if(out!="") out = "\n/* !!! Attention !!! */\n/* This configuration depends on some additional libraries. Please install them using the library manager: */\n/* " + out.slice(0, -2) + " */\n\n";
    return out; /* Pewuuu! */
  }
  function formatExport(input, toClipboard){
    let out = `#ifndef myoptions_h\n#define myoptions_h\n\n/* Generated by myoptions.h generator - ${GVERSION} */\n/* ${getLink(true)} */\n/* Put this file next to yoRadio.ino and restart Arduino IDE. */\n${libsRequired()}/* !!! Do not be alarmed, all right, the default values ​​are not included in this file !!! */\n\n${input}\n\n#endif\n`;
    if(toClipboard){
      navigator.clipboard.writeText(out).then(function() {
        doAlert("info", "Text copied to clipboard!", 2000);
      }, function(err) {
        doAlert("error", "Could not copy text");
      });
      return;
    }
    downloadFile("myoptions.h", out);
  }
  function doExport(toClipboard=false){
    if(!validatePins()) {
      doAlert("error", "Error filling values");
      return;
    }
    let forexport = document.getElementsByClassName("forexport");
    let outstr = "";
    if (esptype == 'ESP32-S3') {
      outstr += "#define ARDUINO_ESP32S3_DEV\n\n";
    } else if (esptype == 'ESP32-C3') {
      outstr += "#define ARDUINO_ESP32C3_DEV\n\n";
    }
    let sdcustom = document.getElementsByClassName("sdcustom")[0];
    let usesdcustom = sdcustom.checked && sdcustom.offsetParent !== null;
    if(usesdcustom) {
			let sdspic=document.getElementsByClassName("sdspic");
			let sdout = "";
			for (var sd = 0; sd < sdspic.length; sd++) {
				sdout+=sdspic[sd].value+", ";
			}
			outstr += "#define SD_SPIPINS\t"+sdout.slice(0, -2)+"\t\t\t/* SCK, MISO, MOSI */\n";
		}
    for (var i = 0; i < forexport.length; i++) {
      if(forexport[i].offsetParent === null) continue;
      /*************************************************************/
      if(forexport[i].getAttribute('data-export')=="RADIO"){
        let define = forexport[i].getAttribute('data-define');
        let elements = forexport[i].getElementsByClassName("radio");
        for (var j = 0; j < elements.length; j++) {
          if(elements[j].checked && elements[j].offsetParent !== null){
            let dtype = elements[j].getAttribute('data-type');
            if(dtype=="default" || usesdcustom) break;
            outstr += "#define " + define + "\t\t\t" + dtype + "\n";
            break;
          }
        }
        let rotate90 = document.getElementsByClassName("rotate90")[0];
        let invertTitle = document.getElementsByClassName("invert-title")[0];
        
        if(rotate90.checked && rotate90.offsetParent !== null && forexport[i].hasAttribute("data-displays")) outstr += "#define ROTATE_90\t\t\ttrue\n";
        if(invertTitle.checked && invertTitle.offsetParent !== null && forexport[i].hasAttribute("data-invert")) outstr += "#define DSP_INVERT_TITLE\t\t\ttrue\n";
      }
      
      /*************************************************************/
      if(forexport[i].getAttribute('data-export')=="PINS"){
        let isButtons = forexport[i].classList.contains("buttons-pins");
        let elements = forexport[i].getElementsByClassName("textinput");
        for (var j = 0; j < elements.length; j++) {
        	if(elements[j].classList.contains('exclude')) continue;
          if(elements[j].offsetParent !== null){
            let define = elements[j].getAttribute('data-define');
            let dtype = elements[j].value;
            if(dtype==""){
              elements[j].classList.add("error");
              elements[j].scrollIntoView({behavior: "smooth", block: "center", inline: "nearest"});
              return;
            }
            if (define === "LED_BUILTIN" && document.getElementById("r79")) {
              outstr += "#define USE_BUILTIN_LED" + "\t\t\tfalse\n";
              outstr += "#define LED_BUILTIN_S3\t\t\t" + dtype + "\n";
            } else {
              if(defaultValues[define]!=dtype) outstr += "#define " + define + "\t\t\t" + dtype + "\n";
            }
          }
        }
        if(isButtons){
          let buttonpullup = document.getElementsByClassName("buttonspullup")[0];
          if(!buttonpullup.checked && buttonpullup.offsetParent !== null) outstr += "#define BTN_INTERNALPULLUP\t\t\tfalse\n";
        }
      }
      /*************************************************************/
      if(forexport[i].getAttribute('data-export')=="SET"){
        let elements = forexport[i].getElementsByClassName("setitem");
        for (var j = 0; j < elements.length; j++) {
          if(elements[j].offsetParent !== null && elements[j].checked != (elements[j].getAttribute('data-default') === 'true')){
            let define = elements[j].getAttribute('data-define');
            outstr += "#define " + define + "\t\t\t" + elements[j].checked + "\n";
          }
        }
      }
      /*************************************************************/
      if(forexport[i].getAttribute('data-export')=="AUDIO"){
        if(document.getElementsByClassName("vs1053")[0].checked) outstr += "#define I2S_DOUT\t\t\t255\n";
        if(document.getElementsByClassName("i2s-internal")[0].checked) outstr += "#define I2S_INTERNAL\t\t\ttrue\n";
        if(document.getElementsByClassName("force-mono")[0].checked) outstr += "#define PLAYER_FORCE_MONO\t\t\ttrue\n";
      }
      /*************************************************************/
    }
    formatExport(outstr,toClipboard);
  }
  /* DRAGDROP */
  let dragged;
  let node;
  let draggedId;
  document.addEventListener("dragstart", ({target}) => {
	  dragged = target;
	  draggedId = target.id;
	  node = target.parentNode;
  });

  document.addEventListener("dragover", (event) => {
    event.preventDefault();
  });

  document.addEventListener("drop", ({target}) => {
    if(target.id==draggedId) return;
    if(target.parentNode.classList.contains("movable-rst")) {
      dragged.remove( dragged );
      target.parentNode.appendChild(dragged);
      let targetVal = "-1";
      document.getElementById(dragged.getAttribute("data-parent")).value = targetVal;
      dragged.innerHTML = dragged.getAttribute("data-define") + "&nbsp;["+targetVal+"]";
      dragged.setAttribute("data-value", targetVal);
      return;
    }
    if(target.classList.contains("movable-rst")) {
      dragged.remove( dragged );
      target.appendChild(dragged);
      let targetVal = "-1";
      document.getElementById(dragged.getAttribute("data-parent")).value = targetVal;
      dragged.innerHTML = dragged.getAttribute("data-define") + "&nbsp;["+targetVal+"]";
      dragged.setAttribute("data-value", targetVal);
      return;
    }
    if(target.id=="preview-pins-unused") {
      dragged.remove( dragged );
      target.appendChild(dragged);
      let targetVal = "255";
      document.getElementById(dragged.getAttribute("data-parent")).value = targetVal;
      dragged.innerHTML = dragged.getAttribute("data-define");
      dragged.setAttribute("data-value", targetVal);
      document.getElementById("preview").style.paddingLeft=document.getElementById("preview-pins-unused").offsetWidth + 20 + "px";
      return;
    }
	  if(target.classList.contains("movable")) {
	    let isEmpty = target.getElementsByClassName("preview-pin").length==0;
	    if(!isEmpty) return;
	    dragged.remove( dragged );
	    let targetVal = target.id.split("-")[1];
		  target.appendChild(dragged);
		  document.getElementById(dragged.getAttribute("data-parent")).value = targetVal;
		  dragged.innerHTML = dragged.getAttribute("data-define") + "&nbsp;["+targetVal+"]";
		  dragged.setAttribute("data-value", targetVal);
	  }
	  if(target.classList.contains("preview-pin") && target.parentNode.classList.contains("movable") && target.parentNode.id!="preview-pins-unused"){
	    dragged.remove( dragged );
	    let targetVal = target.getAttribute("data-value");
	    let draggedVal = dragged.getAttribute("data-value");
	    target.parentNode.appendChild(dragged);
	    document.getElementById(dragged.getAttribute("data-parent")).value = targetVal;
	    dragged.innerHTML = dragged.getAttribute("data-define") + "&nbsp;["+targetVal+"]";
	    dragged.setAttribute("data-value", targetVal);
	    node.appendChild(target);
	    document.getElementById(target.getAttribute("data-parent")).value = draggedVal;
	    target.innerHTML = target.getAttribute("data-define") + (target.parentNode.id=="preview-pins-unused"?"":"&nbsp;["+draggedVal+"]");
	    target.setAttribute("data-value", draggedVal);
	  }
	  document.getElementById("preview").style.paddingLeft=document.getElementById("preview-pins-unused").offsetWidth + 20 + "px";
  });
</script>

</html>
